var crypto = require('crypto');
var _ = require('lodash');

var Oauth = {

    buildSignature: function(params, url, method){
        var method = method.toUpperCase();
        var url = encodeURIComponent(url);

        var parameterString = '';

        _.each(params, function(item){
            parameterString += '&' + item.key + '=' + item.value;
        })

        parameterString = parameterString.substring(1);

        var baseString = method + '&' + url + '&' + encodeURIComponent(parameterString);

        var signature = crypto.createHmac('sha1', signingKey).update(baseString).digest('base64');

        return signature;
    }

};

module.exports = Oauth;